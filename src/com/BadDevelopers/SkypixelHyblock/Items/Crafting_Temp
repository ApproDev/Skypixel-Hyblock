package com.BadDevelopers.SkypixelHyblock.Items;

import java.util.ArrayList;

import com.BadDevelopers.SkypixelHyblock.Items.ItemHolder.Item;

public class Crafting {
	
	
	public final Recipe recipe;
	public final Item[][] formation;
	public final Integer[][] fQ;
	public Crafting(Recipe recipe, Item[][] formation, Integer[][] fQ) {
		this.recipe = recipe;
		this.formation = formation;
		this.fQ = fQ;
	}
	
	
	
	
	
	public static enum Recipe {
		OAK_LOG_TO_PLANKS(Item.OAK_PLANKS, 4, Item.OAK_LOG, 1),
		
		NULL(Item.NULL, 0, Item.NULL, 1);
		
		Item[][] recipe;
		Integer[][] quantity;
		public Item out;
		public int outQ;
		
		Recipe(Item out, int outQuantity, Item middle, Integer middleQ) {
			recipe = new Item[][] {{middle}};
			quantity = new Integer[][] {{middleQ}};
			this.out = out;
		}
		
		
		@SuppressWarnings("unused")
		public static Crafting getRecipe(Item[][] table) {
			for (Recipe rec : values()) {
				Item[][] recipe = rec.recipe;
				for (int x = 0; x < (table.length - recipe.length) + 1; x++) {
					Item[] recRow = recipe[x];
					Item[] tableRow = table[x];
					for (int y = 0; y < (tableRow.length - recRow.length) + 1; y++) {
						ArrayList<ArrayList<Integer>> qFArray = new ArrayList<ArrayList<Integer>>();
						ArrayList<ArrayList<Item>> formationArray = new ArrayList<ArrayList<Item>>();
						loop :for (int itemX = x; itemX < recipe.length + x - 1; itemX++)
							for (int itemY = y; itemY < recipe[itemY].length + y - 1; itemY++) {
								if (qFArray.size() == 0) {
									for (int tempX = 0; tempX < itemX; tempX++) {
									qFArray.add(new ArrayList<Integer>());}
									for (int tempY = 0; tempY < itemY; tempY++) {
										ArrayList<Integer> array = qFArray.get(tempY);
										for (int i = 0; i < qFArray.size(); i++) array.add(null);
										qFArray.set(tempY, array);
									}
									for (int tempX = 0; tempX < itemX; tempX++) {
										formationArray.add(new ArrayList<Item>());}
										for (int tempY = 0; tempY < itemY; tempY++) {
											ArrayList<Item> array = formationArray.get(tempY);
											for (int i = 0; i < formationArray.size(); i++) array.add(null);
											formationArray.set(tempY, array);
										}
								}
								ArrayList<Item> array = formationArray.get(x);
								array.set(y, recipe[x][y]);
								formationArray.set(x, array);
								ArrayList<Integer> array2 = qFArray.get(x);
								array2.set(y, rec.quantity[x][y]);
								qFArray.set(x, array2);
								if (!recipe[x][y].equals(table[itemX][itemY])) {
									formationArray = new ArrayList<ArrayList<Item>>();
									qFArray = new ArrayList<ArrayList<Integer>>();
									break loop;
								}
							}
						while (qFArray.size() < 3) {
							qFArray.add(new ArrayList<Integer>());
						}
						for (int n = 0; n < qFArray.get(0).size(); n++) {
							ArrayList<Integer> al = qFArray.get(n);
								
							while (al.size() < 3) al.add(null);
								
							qFArray.set(n, al);
						}
						while (qFArray.size() < 3) {
							qFArray.add(new ArrayList<Integer>());
						}
						for (int n = 0; n < formationArray.get(0).size(); n++) {
							ArrayList<Item> al = formationArray.get(n);
								
							while (al.size() < 3) al.add(null);
								
							formationArray.set(n, al);
						}
						
						return new Crafting(rec, toItemArray(formationArray), toIntegerArray(qFArray));
					}
				}
			}
			return new Crafting(Recipe.NULL, new Item[0][0], new Integer[0][0]);
		}
		
		static Integer[][] toIntegerArray(ArrayList<ArrayList<Integer>> list) {
			ArrayList<Integer[]> list1 = new ArrayList<Integer[]>();
			int innerSize = 0;
			for (ArrayList<Integer> element : list) {
				Integer[] array = element.toArray(new Integer[element.size()]);
				if (array.length > innerSize) innerSize = array.length;
				list1.add(array);
			}
			
			return list1.toArray(new Integer[list1.size()][innerSize]);
		}
		
		static Item[][] toItemArray(ArrayList<ArrayList<Item>> list) {
			ArrayList<Item[]> list1 = new ArrayList<Item[]>();
			int innerSize = 0;
			for (ArrayList<Item> element : list) {
				Item[] array = element.toArray(new Item[element.size()]);
				if (array.length > innerSize) innerSize = array.length;
				list1.add(array);
			}
			
			return list1.toArray(new Item[list1.size()][innerSize]);
		}
	}
	
}
